<!DOCTYPE html>
<html lang="en">
<head>
	<link rel="stylesheet" href="css/prettify.css">
	<link rel="stylesheet" href="css/style.css">
	<script type="text/javascript" src="js/prettify.js"></script>
	<script type="text/javascript" src="js/lang-css.js"></script>
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>stuQuery hexmap</title>
	<meta name="twitter:card" content="summary">
	<meta name="twitter:site" content="@astronomyblog">
	<meta name="twitter:url" property="og:url" content="https://slowe.github.io/stuquery/hexmap">
	<meta name="twitter:title" property="og:title" content="stuQuery hexmap">
	<meta name="twitter:description" property="og:description" content="A simple HTML-based hexmap library that makes use of stuQuery">
	<meta name="twitter:image" property="og:image" content="https://slowe.github.io/stuquery/images/hexmap.png">
	<meta name="keywords" content="html,javascript,hexmap,hex,hexjson">
	<style>
	section:hover { background-color: #efefef; }
	section:hover pre { background-color: #f9f9fa; }
	section pre { margin-bottom: 0px; }
	#content { top: 4em; }
	</style>
</head>
<body>

	<a href="https://github.com/slowe/stuquery" id="forkme_banner">Fork Me on GitHub</a>

	<header style="position:absolute;left:0px;top:0px;width:100%;height:8em;overflow:hidden;">
		<div style="position:relative;width:105%;min-width:1024px;left:-1.75em;top:-1em;">
		<div id="hexmap">
			<code>
{
	"layout":"odd-r",
		"hexes": {
		"0-0":{"q":0,"r":0},
		"0-1":{"q":1,"r":0},
		"0-2":{"q":2,"r":0},
		"0-3":{"q":3,"r":0},
		"0-4":{"q":4,"r":0},
		"0-5":{"q":5,"r":0},
		"0-6":{"q":6,"r":0},
		"0-7":{"q":7,"r":0},
		"0-8":{"q":8,"r":0},
		"0-9":{"q":9,"r":0},
		"0-10":{"q":10,"r":0},
		"0-11":{"q":11,"r":0},
		"0-12":{"q":12,"r":0},
		"0-13":{"q":13,"r":0},
		"0-14":{"q":14,"r":0},
		"0-15":{"q":15,"r":0},
		"0-16":{"q":16,"r":0},
		"0-17":{"q":17,"r":0},
		"0-18":{"q":18,"r":0},
		"0-19":{"q":19,"r":0},
		"0-20":{"q":20,"r":0},
		"0-21":{"q":21,"r":0},
		"0-22":{"q":22,"r":0},
		"0-23":{"q":23,"r":0},
		"0-24":{"q":24,"r":0},
		"0-25":{"q":25,"r":0},
		"0-26":{"q":26,"r":0},
		"0-27":{"q":27,"r":0},
		"0-28":{"q":28,"r":0},
		"0-29":{"q":29,"r":0},
		"0-30":{"q":30,"r":0},
		"0-31":{"q":31,"r":0},
		"0-32":{"q":32,"r":0},
		"0-33":{"q":33,"r":0},
		"0-34":{"q":34,"r":0},
		"1-0":{"q":0,"r":1},
		"1-1":{"q":1,"r":1},
		"1-2":{"q":2,"r":1},
		"1-3":{"q":3,"r":1},
		"1-4":{"q":4,"r":1},
		"1-5":{"q":5,"r":1},
		"1-6":{"q":6,"r":1},
		"1-7":{"q":7,"r":1},
		"1-8":{"q":8,"r":1},
		"1-9":{"q":9,"r":1},
		"1-10":{"q":10,"r":1},
		"1-11":{"q":11,"r":1},
		"1-12":{"q":12,"r":1},
		"1-13":{"q":13,"r":1},
		"1-14":{"q":14,"r":1},
		"1-15":{"q":15,"r":1},
		"1-16":{"q":16,"r":1},
		"1-17":{"q":17,"r":1},
		"1-18":{"q":18,"r":1},
		"1-19":{"q":19,"r":1},
		"1-20":{"q":20,"r":1},
		"1-21":{"q":21,"r":1},
		"1-22":{"q":22,"r":1},
		"1-23":{"q":23,"r":1},
		"1-24":{"q":24,"r":1},
		"1-25":{"q":25,"r":1},
		"1-26":{"q":26,"r":1},
		"1-27":{"q":27,"r":1},
		"1-28":{"q":28,"r":1},
		"1-29":{"q":29,"r":1},
		"1-30":{"q":30,"r":1},
		"1-31":{"q":31,"r":1},
		"1-32":{"q":32,"r":1},
		"1-33":{"q":33,"r":1},
		"1-34":{"q":34,"r":1},
		"2-0":{"q":0,"r":2},
		"2-1":{"q":1,"r":2},
		"2-2":{"q":2,"r":2},
		"2-3":{"q":3,"r":2},
		"2-4":{"q":4,"r":2},
		"2-5":{"q":5,"r":2},
		"2-6":{"q":6,"r":2},
		"2-7":{"q":7,"r":2},
		"2-8":{"q":8,"r":2},
		"2-9":{"q":9,"r":2},
		"2-10":{"q":10,"r":2},
		"2-11":{"q":11,"r":2},
		"2-12":{"q":12,"r":2},
		"2-13":{"q":13,"r":2},
		"2-14":{"q":14,"r":2},
		"2-15":{"q":15,"r":2},
		"2-16":{"q":16,"r":2},
		"2-17":{"q":17,"r":2},
		"2-18":{"q":18,"r":2},
		"2-19":{"q":19,"r":2},
		"2-20":{"q":20,"r":2},
		"2-21":{"q":21,"r":2},
		"2-22":{"q":22,"r":2},
		"2-23":{"q":23,"r":2},
		"2-24":{"q":24,"r":2},
		"2-25":{"q":25,"r":2},
		"2-26":{"q":26,"r":2},
		"2-27":{"q":27,"r":2},
		"2-28":{"q":28,"r":2},
		"2-29":{"q":29,"r":2},
		"2-30":{"q":30,"r":2},
		"2-31":{"q":31,"r":2},
		"2-32":{"q":32,"r":2},
		"2-33":{"q":33,"r":2},
		"2-34":{"q":34,"r":2}	}
}

			</code>
		</div>
		</div>
	</header>
		
	<div id="content">

		<section id="downloads">
			<a href="js/stuquery.hexmap.js">stuquery.hexmap.js (11kB)</a>
			<a href="css/stuquery.hexmap.css">stuquery.hexmap.css (1kB)</a>
		</section>

		<h1>stuQuery hexmap</h1>


		<p>This is a simple HTML-based hexmapping library that makes use of <a href="index.html">stuQuery</a>. Being created from simple HTML elements, it is easy to style the hexes with CSS. Each hex is accessible via the keyboard too.</p>
		<p>Make sure to include the relevant CSS and Javascript files in your HTML page:</p>

		<div class="example" data-title="false">
<script type="text/javascript" src="js/stuquery.js"></script>
<script type="text/javascript" src="js/stuquery.hexmap.js"></script>
<link rel="stylesheet" href="css/stuquery.hexmap.css">
</div>
		

		<section id="basic">
			<h2>Basic hex map</h2>
			<p>Let's create a simple hex map. We define the hex map by embedding some <a href="https://odileeds.org/projects/hexmaps/hexjson">HexJSON</a> (that way the raw data is visible if Javascript fails).</p>
			<div class="example">
<div id="hexmap-1">
<code>
{
	"layout":"odd-r",
	"hexes": {
		"A":{"n":"Hex a","q":0,"r":0},
		"B":{"n":"Hex b","q":0,"r":1},
		"C":{"n":"Hex c","q":1,"r":0},
		"D":{"n":"Hex d","q":1,"r":1},
		"E":{"n":"Hex e","q":2,"r":0},
		"F":{"n":"Hex f","q":2,"r":1},
		"G":{"n":"Hex g","q":0,"r":2},
		"H":{"n":"Hex h","q":1,"r":2},
		"I":{"n":"Hex i","q":2,"r":2}
	}
}
</code>
</div>

<!-- Javascript -->
<script>
S(document).ready(function(){

	// Create an object attached to a DOM element with the ID "hexmap-1"
	var hexmap = S.hexmap('hexmap-1');

	// Position the hexes and scale them to the container
	hexmap.positionHexes().resize();

});
</script>
</div>
		</section>

	
		<section id="label">
			<h2>Custom label on each hex</h2>
			<p>Let's create a simple hex map but add a visible label to each hex.</p>
			<div class="example">
<div id="hexmap-2">
<code>
{
	"layout":"odd-r",
	"hexes": {
		"A":{"n":"Hex a","q":0,"r":0},
		"B":{"n":"Hex b","q":0,"r":1},
		"C":{"n":"Hex c","q":1,"r":0},
		"D":{"n":"Hex d","q":1,"r":1},
		"E":{"n":"Hex e","q":2,"r":0},
		"F":{"n":"Hex f","q":2,"r":1},
		"G":{"n":"Hex g","q":0,"r":2},
		"H":{"n":"Hex h","q":1,"r":2},
		"I":{"n":"Hex i","q":2,"r":2}
	}
}
</code>
</div>

<!-- Javascript -->
<script>
S(document).ready(function(){
	var hexmap = S.hexmap('hexmap-2',{
		'formatLabel': function(id,hex){
			// "id" = unique ID of the hex
			// "hex" = object containing the properties of the specific hex
			return hex.n;
		}
	});

	hexmap.positionHexes().resize();
});
</script>
</div>
		</section>

	
		<section id="label-extra">
			<h2>Extra labels on select</h2>
			<p>Now we'll add labels to each hex which have elements that are always visible and elements that only appear when the hex is selected or hovered.</p>
			<div class="example">
<div id="hexmap-3">
<code>
{
	"layout":"odd-r",
	"hexes": {
		"A":{"n":"Hex a","q":0,"r":0},
		"B":{"n":"Hex b","q":0,"r":1},
		"C":{"n":"Hex c","q":1,"r":0},
		"D":{"n":"Hex d","q":1,"r":1},
		"E":{"n":"Hex e","q":2,"r":0},
		"F":{"n":"Hex f","q":2,"r":1},
		"G":{"n":"Hex g","q":0,"r":2},
		"H":{"n":"Hex h","q":1,"r":2},
		"I":{"n":"Hex i","q":2,"r":2}
	}
}
</code>
</div>

<!-- Javascript -->
<script>
S(document).ready(function(){
	var hexmap = S.hexmap('hexmap-3',{
		'formatLabel': function(id,hex){
			// "id" = unique ID of the hex
			// "hex" = object containing the properties of the specific hex
			str = hex.n
			str += '<div class="default">Default</div>'
			str += '<div class="when-selected">Hover</div>';
			return str;
		}
	});

	hexmap.positionHexes().resize();
});
</script>
</div>
		</section>

	
		<section id="label-extra">
			<h2>Hex-specific colours</h2>
			<p>Sometimes you might want to make your hex map into a heat map. To do that we send a callback function that returns an object of the form <code>{ 'background-color': '#ff0000', 'color': 'black' }</code></p>
			<div class="example">
<div id="hexmap-4">
<code>
{
	"layout":"odd-r",
	"hexes": {
		"A":{"n":"Hex a","q":0,"r":0},
		"B":{"n":"Hex b","q":0,"r":1},
		"C":{"n":"Hex c","q":1,"r":0},
		"D":{"n":"Hex d","q":1,"r":1},
		"E":{"n":"Hex e","q":2,"r":0},
		"F":{"n":"Hex f","q":2,"r":1},
		"G":{"n":"Hex g","q":0,"r":2},
		"H":{"n":"Hex h","q":1,"r":2},
		"I":{"n":"Hex i","q":2,"r":2}
	}
}
</code>
</div>

<!-- Javascript -->
<script>
S(document).ready(function(){
	var hexmap = S.hexmap('hexmap-4');

	hexmap.positionHexes().resize();

	hexmap.setColour(function(hex){
		// The "hex" variable contains the properties of the specific hex
		// The "this" variable references the hexmap object itself

		var colours = ['#00B6FF','#EF3AAB','#F9BC26','#67E767','#08DEF9'];

		// We will choose a colour which is the sum of the q and r coordinate
		return {'background-color':colours[Math.abs(hex.q+hex.r)],'color':'black'};
	});

});
</script>
</div>
		</section>
	
	
	
	

		<section id="hover-style">
			<h2>Hover styling</h2>
			<p>As the hexes are created as DOM elements, we can style them with CSS</p>
			<div class="example">
<!-- HTML -->
<div id="hexmap-5" class="ex5">
<code>
{
	"layout":"odd-r",
	"hexes": {
		"A":{"n":"Hex a","q":0,"r":0},
		"B":{"n":"Hex b","q":0,"r":1},
		"C":{"n":"Hex c","q":1,"r":0},
		"D":{"n":"Hex d","q":1,"r":1},
		"E":{"n":"Hex e","q":2,"r":0},
		"F":{"n":"Hex f","q":2,"r":1},
		"G":{"n":"Hex g","q":0,"r":2},
		"H":{"n":"Hex h","q":1,"r":2},
		"I":{"n":"Hex i","q":2,"r":2}
	}
}
</code>
</div>

<!-- Javascript -->
<script>
S(document).ready(function(){
	var hexmap = S.hexmap('hexmap-5');
	hexmap.positionHexes().resize();
});
</script>

<!-- CSS -->
<style>
/* Attach styles to hover and focus events */
.ex5 .hex:hover {
	background-color: black;
}
.ex5 .hex:hover .hexinner, 
.ex5 .hex:focus .hexinner {
	background: rgb(249, 188, 38);!important;
	color: black;
	margin: 10px;
	cursor: pointer;
}
</style>
</div>
		</section>





		<section id="callback">
			<h2>Adding callbacks</h2>
			<p>You may want to make your hexes interactive. You can attach callback functions to events such as <code>click</code>, <code>mouseover</code>, <code>mouseout</code>, and <code>focus</code>.</p>
			<div class="example">
<!-- HTML -->
<div id="message-6">Click or hover on a hex</div>
<div id="hexmap-6" class="ex6">
<code>
{
	"layout":"odd-r",
	"hexes": {
		"A":{"n":"Hex a","q":0,"r":0},
		"B":{"n":"Hex b","q":0,"r":1},
		"C":{"n":"Hex c","q":1,"r":0},
		"D":{"n":"Hex d","q":1,"r":1},
		"E":{"n":"Hex e","q":2,"r":0},
		"F":{"n":"Hex f","q":2,"r":1},
		"G":{"n":"Hex g","q":0,"r":2},
		"H":{"n":"Hex h","q":1,"r":2},
		"I":{"n":"Hex i","q":2,"r":2}
	}
}
</code>
</div>

<!-- Javascript -->
<script>
S(document).ready(function(){
	var hexmap = S.hexmap('hexmap-6');
	hexmap.positionHexes().resize();
	hexmap.on('click',function(e){

		S('#message-6').html('You have clicked hex '+e.i+' ('+e.hex.id+')')

	}).on('mouseover',function(e){

		S('#message-6').html('You have hovered over hex '+e.i+' ('+e.hex.id+')')

	}).on('mouseout',function(e){

		S('#message-6').html('You have left hex '+e.i+' ('+e.hex.id+')')

	}).on('focus',function(e){

		S('#message-6').html('You have focussed on hex '+e.i+' ('+e.hex.id+')')

	});
});
</script>

<!-- CSS -->
<style>
/* Attach styles to hover and focus events */
#message-6 {
	position: relative;
	display: inline-block;
	left: 50%;
	transform: translate3D(-50%,0,0);
	background: black;
	color: white;
	padding: 0.25em 0.5em;
	float: left;
	z-index: 10;
}
.ex6 .hex {
	cursor: pointer;
}
.ex6 .hex:hover .hexinner, 
.ex6 .hex:focus .hexinner {
	background: black!important;
	color: white;
}
</style>
</div>
		</section>





		<section id="setContent">
			<h2>Update the content</h2>
			<p>You may want to update the content of your hexes.</p>
			<div class="example">
<!-- HTML -->
<div id="hexmap-7">
<code>
{
	"layout":"odd-r",
	"hexes": {
		"A":{"n":"Hex a","q":0,"r":0},
		"B":{"n":"Hex b","q":0,"r":1},
		"C":{"n":"Hex c","q":1,"r":0},
		"D":{"n":"Hex d","q":1,"r":1},
		"E":{"n":"Hex e","q":2,"r":0},
		"F":{"n":"Hex f","q":2,"r":1},
		"G":{"n":"Hex g","q":0,"r":2},
		"H":{"n":"Hex h","q":1,"r":2},
		"I":{"n":"Hex i","q":2,"r":2}
	}
}
</code>
</div>
<button id="button-7-id">Show IDs</button>
<button id="button-7-clear">Clear</button>

<!-- Javascript -->
<script>
S(document).ready(function(){
	var hexmap = S.hexmap('hexmap-7');
	hexmap.positionHexes().resize();
	

	// Add event to button click
	S('#button-7-id').on('click',function(){

		// When the button is pressed we update the content of all the hexes
		hexmap.setContent(function(id,hex){
			// "id" = unique ID of the hex
			// "hex" = object containing the properties of the specific hex
			return id;
		})

	});

	// Add event to button click
	S('#button-7-clear').on('click',function(){

		// When the button is pressed we clear the content of all the hexes
		hexmap.setContent(function(id,hex){ return ''; });

	});
});
</script>
</div>
		</section>







		<section id="game">
			<h2>Settling hex island</h2>
			<p>Some hexes styled like the starting map of a famous board game.</p>
			<div class="example">
<!-- HTML -->
<div id="hexmap-8" class="ex-8">
<code>
{
	"layout":"odd-r",
	"hexes": {
		"A":{"n":"A","q":0,"r":0,"dice":5,"type":"mountains"},
		"B":{"n":"B","q":1,"r":0,"dice":2,"type":"fields"},
		"C":{"n":"C","q":2,"r":0,"dice":6,"type":"forest"},
		"D":{"n":"D","q":2,"r":1,"dice":3,"type":"mountains"},
		"E":{"n":"E","q":3,"r":2,"dice":8,"type":"fields"},
		"F":{"n":"F","q":2,"r":3,"dice":10,"type":"pasture"},
		"G":{"n":"G","q":2,"r":4,"dice":9,"type":"fields"},
		"H":{"n":"H","q":1,"r":4,"dice":12,"type":"pasture"},
		"I":{"n":"I","q":0,"r":4,"dice":11,"type":"forest"},
		"J":{"n":"J","q":-1,"r":3,"dice":4,"type":"hills"},
		"Robber":{"n":"Robber","q":-1,"r":2,"dice":7,"type":"desert"},
		"K":{"n":"K","q":-1,"r":1,"dice":8,"type":"hills"},
		"L":{"n":"L","q":0,"r":1,"dice":10,"type":"pasture"},
		"M":{"n":"M","q":1,"r":1,"dice":9,"type":"pasture"},
		"N":{"n":"N","q":2,"r":2,"dice":4,"type":"forest"},
		"O":{"n":"O","q":1,"r":3,"dice":5,"type":"hills"},
		"P":{"n":"P","q":0,"r":3,"dice":6,"type":"mountains"},
		"Q":{"n":"Q","q":0,"r":2,"dice":3,"type":"forest"},
		"R":{"n":"R","q":1,"r":2,"dice":11,"type":"fields"}
	}
}
</code>
</div>
<div style="text-align:center;margin-top:1em;">
	<button id="button-8-terrain">Randomise terrain</button>
</div>

<!-- Javascript -->
<script>
S(document).ready(function(){
	var hexmap = S.hexmap('hexmap-8');
	hexmap.positionHexes().resize();
	hexmap.setContent(function(id,hex){
		odds = [0,0,1,2,3,4,5,6,5,4,3,2,1];
		ostr = '';
		for(var i = 0; i < odds[hex.dice]; i++){
			ostr += '&#9679;'
		}
		str = '<div class="token'+((hex.dice==8 || hex.dice == 6) ? ' token-red':'')+'">';
		if(hex.n == "Robber"){
			str += 'Robber';
		}else{
			str += '<div class="id">'+id+'</div>';
			str += '<div class="dice">'+hex.dice+'</div>';
			str += '<div class="odds">'+ostr+'</div>';
		}
		str += '</div>';
		return str;
	});
	hexmap.setClass(function(id,hex){
		return hex.type;
	});

	// Create button which randomises the terrain
	S('#button-8-terrain').on('click',function(){

		// Define the terrain types
		var terrains = ['hills','pasture','mountains','fields','forest'];

		// Create an array of terrains to populate
		var t = new Array(hexmap.hexes.length);

		// Randomly assign terrains
		for(var i = 0; i < hexmap.hexes.length; i++) t[i] = terrains[Math.floor(Math.random()*terrains.length)];

		// Update all the classes
		for(var i = 0; i < hexmap.hexes.length; i++){
			if(hexmap.hexes[i].n != "Robber") hexmap.hexes[i].setClass(t[i]);
		}
	});
});
</script>

<!-- CSS -->
<style>
.ex-8 {
	background-color: #66bbe2;
	padding: 6% 10%;
	margin: auto;
	clip-path: polygon(0% 50%, 25% 100%, 75% 100%, 100% 50%, 75% 0%, 25% 0%);
}
.token {
	font-family: serif;
	border-radius: 100%;
	background-color: wheat;
	width: 4em;
	height: 4em;
	color: black;
	display: table-cell;
	vertical-align: middle;
}
.token.token-red { color: crimson; }
.token .id, .token .odds { font-size: 0.5em; }
.token .dice { font-size: 2em; }
.hills { background-color: #c8906e; }
.pasture { background-color: #b5c881; }
.mountains { background-color: #778088; }
.fields { background-color: #e9b66c; }
.forest { background-color: #55855f; }
.desert { background-color: #f5dcad; }
</style>
</div>
		</section>







	</div>










	<script>
	ex = S('.example');
	function tidy(t){ return t.replace(/===NEWLINE===/g,"\n").replace(/\n*$/,""); }
	function sanitise(t){ return t.replace(/\</g,"&lt;").replace(/\>/g,"&gt;"); }
	for(var i = 0; i < ex.length; i++){
		html = ex[i].innerHTML;
		css = "";
		js = "";
		temp = html.replace(/\n/g,"===NEWLINE===");
		temp = temp.replace(/<!-- Javascript -->/i,"").replace(/<script>(.*)<\/script>/,function(m,p1){
			js = tidy(p1);
			return "";
		});
		temp = temp.replace(/<!-- CSS -->/i,"").replace(/<style>(.*)<\/style>/,function(m,p1){
			css = tidy(p1);
			return "";
		});
		
		code = sanitise(tidy(temp));
		code = code.replace(/(src|href)=\"([^\"]+)\"/g,function(m,p1,p2){ return p1+'="<a href="'+p2+'">'+p2+'</a>"'; })
		showtitle = true;
		if(S(ex[i]).attr('data-title')=="false") showtitle = false;
		
		ex[i].innerHTML = ''+html+(showtitle ? '<h3>How to do it</h3>':'')+'<h4>HTML</h4><pre class="prettyprint lang-html">'+code+'</pre>'+(css ? '<h4>CSS</h4><pre class="prettyprint lang-css">'+sanitise(css)+'</pre>':'')+(js ? '<h4>Javascript</h4><pre class="prettyprint lang-js">'+sanitise(js)+'</pre>':'');
	}
	prettyPrint();
	var hexmap = S.hexmap();
	S('h1').append(' v'+hexmap.version);

	S(document).ready(function(){

		// Create an object attached to a DOM element with the ID "hexmap-1"
		var hexmap = S.hexmap('hexmap',{'width':3});

		// Position the hexes and scale them to the container
		hexmap.positionHexes().resize();

		var colours = ['#00B6FF','#EF3AAB','#F9BC26','#67E767','#08DEF9'];

		hexmap.setColour(function(hex){

			// We will choose a colour which is the sum of the q and r coordinate
			return {'background-color':colours[Math.floor(Math.random()*colours.length)]};
		});
	
	});

	</script>

</body>
</html>

